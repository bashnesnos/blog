<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8"/>
    <title>БАС</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Александр Семелит">
    <meta name="keywords" content="програмиирование, groovy, java, блог">
    <meta name="generator" content="JBake">

    <!-- Le styles -->
    <link href="/blog/css/bootstrap.min.css" rel="stylesheet">
    <link href="/blog/css/asciidoctor.css" rel="stylesheet">
    <link href="/blog/css/base.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="favicon.ico">
  </head>
  <body>
    <div id="wrap">
   	
	<!-- Fixed navbar -->
        <div class="navbar navbar-inverse navbar-static-top" role="navigation">
          <div class="container">
            <div class="navbar-header "><a href="javascript:window.location.assign('http://bashnesnos.github.io/blog/en/'+window.location.href.replace('http://bashnesnos.github.io/blog/',''));">en</a><a class="navbar-brand" href="/blog">Блог Александра Семелита</a></div>
            <div class="navbar-collapse">
              <ul class="nav navbar-nav">
                <li><a href="/blog/about.html">Вкратце</a></li>
                <li><a href="/blog/feed.xml">Подписаться</a></li>
              </ul>
              <ul class="nav navbar-nav navbar-right">
                <li><a href="https://github.com/bashnesnos"><i class="fa fa-github"></i></a></li>
              </ul>
            </div>
          </div>
        </div>
    <div class="container">
	<div class="page-header">
		<h1>Наш маленький программист снова накодил в углу</h1>
	</div>
  			<a href="/blog/2014/jbake_locale.html"><h1>Пишем блог на двух языках с помощью JBake</h1></a>
  			<p>27 Март 2014</p>
  			<p><p>Что ж, с почином.</p><p>Поскольку блог начался с прочтения этого поста <a href="http://melix.github.io/blog/2014/02/hosting-jbake-github.html">про создание блога с помощью JBake и jbake-gradle-plugin</a>, то мой первый пост будет тоже на эту тему (и прощу прощения за обилие "постов" и "блогов" в этом предложении). Мне определённо нравится Gradle (все текущие проекты собираю с ним), да и выпечка привлекает, так что решил попробовать.</p><p>Всё заработало отлично. Но вот незадача, локализации в JBake нет. Т.е. блог можно вести на одном языке. Так-то больше одного редко кому понадобится, но почему бы и не вести на двух языках, была бы возможность. На том и порешил попытаться <del>всё сломать</del>добавить такую возможность.</p><p>Идея такая: локализованные страницы во время сборки отправлять в отдельную папку. Так как блог предполагается статический, то это самый простой и убийственый вариант. Переключение между локализациями будет заключатся в вырезании из/добавления в URL нужного нам куска. Например, будет происходить следующая трансформация:</p>
<pre><code>src\jbake\content\2014\jbake_locale.md -&gt; \2014\jbake_locale.html (оригинальная страница)
src\jbake\content\2014\en_jbake_locale.md -&gt; \en\2014\jbake_locale.html (локализованная)
</code></pre><p>Т.е. чтобы переключиться на английскую версию в данном примере, надо будет на оригинальной страниjaце в URL добавить <strong>en\</strong>. Что и прозойдёт, если клинкуть <a href="/blog/en/2014/jbake_locale.html">сюда</a></p><p>Экономия заключатся в том, что в исходниках не надо копировать дерево папок туда-сюда, и локализованный с нелокализованным лежат рядышком. JBake сам сгенерит всё, что надо.</p><p>Жёстких ограничений нет, чтобы работало надо придерживаться следующих правил:<br/>* Имя файла с локализацией должно отличаться от имени оригинала только приставкой <em>localeId_</em> (в данном примере <strong>en_</strong>)<br/>* Нужно добавить в jbake.properties типы шаблонов, которые будут использоваться для генерации локализованных версий страниц<br/>* Имена шаблонов должны начинаться с <em>localeId_</em> (в данном примере <strong>en_</strong>)<br/>* В шаблонах надо не забывать приставлять <em>localeId_</em> при ссылках на другие шаблоны и при проставлении гиперссылок</p><p>В общем-то, <em>localeId_</em> определяется из jbake.properties. Если указан темплэйт вида <strong>en_</strong>post, <strong>en_</strong> будет определяться как один из <em>localeId_</em>.</p><p>Итого, вот как выглядит jbake.properties для моего блога:</p>
<pre><code>site.host=http://localhost:8080
template.en_post.file=en_post.ftl
template.en_page.file=en_page.ftl
template.en_index.file=en_index.ftl
template.en_archive.file=en_archive.ftl
template.en_feed.file=en_feed.ftl
render.tags=false
</code></pre><p>Но самих локализованных шаблонов несколько больше (en_menu, en_footer учавствуют не напрямую, а включаются в перечисленные в jbake.properties):</p>
<pre><code>en_archive.ftl
en_feed.ftl
en_footer.ftl
en_header.ftl
en_index.ftl
en_menu.ftl
en_page.ftl
en_post.ftl
</code></pre><p>Пока это работает только для шаблонов Freemarker, буду добавлять в остальные, если фича пройдёт модерацию. Если получится, то это будет мой первый более-менее весомый вклад в ПО с открытым кодом!</p></p>
	
	<hr />
	
	<p>Посмотреть на старые посты в <a href="/blog/archive.html">архиве</a>.</p>

		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
      <div class="container">
        <p class="credit pull-right"><a class="btn btn-default" href="#">Наверх</a></p>
        <p class="muted credit">Александр Семелит &copy; 2014 | Mixed with <a href="http://twitter.github.com/bootstrap/">Bootstrap v3.1.1</a> | Baked with <a href="http://jbake.org">JBake v2.3.0-SNAPSHOT</a></p>
      </div>
    </div>
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/jquery-1.11.0.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/run_prettify.js"></script>
    <script src="http://cdn.lanyrd.net/badges/person-v1.min.js"></script>
  </body>
</html>